---
description: Project Folder Structure
alwaysApply: false
---
src/
â”œâ”€ app/
â”‚  â”œâ”€ (routes)/
â”‚  â”‚  â””â”€ dashboard/
â”‚  â”‚     â””â”€ page.tsx                      â† RSC (can prefetch via tRPC SSR helpers)
â”‚  â”œâ”€ api/
â”‚  â”‚  â””â”€ trpc/[trpc]/route.ts             â† tRPC App Router handler (fetch adapter)
â”‚  â”œâ”€ layout.tsx                          â† RSC (reads session; optional direct DAL read)
â”‚  â””â”€ providers.tsx                       â† <TRPCReactProvider> + React Query provider
â”‚
â”œâ”€ components/
â”‚  â”œâ”€ server/
â”‚  â”‚  â””â”€ UserCard.tsx                     â† RSC (optionally call DAL directly)
â”‚  â””â”€ client/
â”‚     â””â”€ UpdateEmailForm.tsx              â† Client (uses tRPC mutations)
â”‚
â”œâ”€ server/
â”‚  â”œâ”€ api/
â”‚  â”‚  â”œâ”€ trpc.ts                          â† initTRPC, procedures, middleware, ctx
â”‚  â”‚  â”œâ”€ root.ts                          â† mergeRouters({ queries, mutations, subscriptions })
â”‚  â”‚  â””â”€ routers/
â”‚  â”‚     â”œâ”€ queries/
â”‚  â”‚     â”‚  â”œâ”€ user.ts                    â† read-only endpoints â†’ call DAL (pure reads)
â”‚  â”‚     â”‚  â”œâ”€ product.ts
â”‚  â”‚     â”‚  â””â”€ org.ts
â”‚  â”‚     â”œâ”€ mutations/
â”‚  â”‚     â”‚  â”œâ”€ user.ts                    â† write ops â†’ call services (side-effects)
â”‚  â”‚     â”‚  â”œâ”€ product.ts
â”‚  â”‚     â”‚  â””â”€ billing.ts
â”‚  â”‚     â””â”€ subscriptions/
â”‚  â”‚        â””â”€ events.ts                  â† observables (e.g., event bus, ws)
â”‚  â”œâ”€ auth/
â”‚  â”‚  â””â”€ index.ts                         â† getAuth() for ctx (NextAuth/Clerk adapter)
â”‚  â””â”€ db/
â”‚     â””â”€ index.ts                         â† PrismaClient singleton
â”‚
â”œâ”€ lib/
â”‚  â”œâ”€ dal/                                â† **Data Access Layer (READS)**
â”‚  â”‚  â”œâ”€ user.ts                          â† (optional) cache() if called from RSC
â”‚  â”‚  â”œâ”€ product.ts
â”‚  â”‚  â””â”€ org.ts
â”‚  â”œâ”€ services/                           â† domain services (compose DAL + writes)
â”‚  â”‚  â”œâ”€ userService.ts                   â† NO cache(); validations, side-effects
â”‚  â”‚  â””â”€ billing.ts
â”‚  â”œâ”€ http.ts                             â† fetch wrappers (tags/revalidate if needed)
â”‚  â””â”€ trpc/                               â† client-side helpers
â”‚     â”œâ”€ client.ts                        â† tRPC client + React Query link
â”‚     â””â”€ react.ts                         â† `api` proxy + hooks generator
â”‚
â”œâ”€ utils/
â”‚  â”œâ”€ env.ts                              â† zod-validated env (server/client split)
â”‚  â””â”€ types.ts
â”‚
â”œâ”€ styles/
â”‚  â””â”€ globals.css
â”‚
â”œâ”€ prisma/
â”‚  â”œâ”€ schema.prisma
â”‚  â””â”€ migrations/
â”‚
â””â”€ pages.d.ts                             â† next-env or ambient types if needed


<!-- ğŸ“ src/
â”œâ”€â”€ ğŸ“ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ ğŸ“ api/trpc/[trpc]/   # tRPC App Router handler
â”‚   â”œâ”€â”€ layout.tsx            # Root layout
â”‚   â”œâ”€â”€ page.tsx              # Home page  
â”‚   â””â”€â”€ providers.tsx         # TRPCReactProvider + React Query
â”‚
â”œâ”€â”€ ğŸ“ components/            # React Components
â”‚   â”œâ”€â”€ ğŸ“ client/           # Client Components (tRPC mutations)
â”‚   â”‚   â””â”€â”€ LatestPost.tsx   # Interactive form component
â”‚   â””â”€â”€ ğŸ“ server/           # Server Components (DAL calls)
â”‚
â”œâ”€â”€ ğŸ“ server/               # Server-side code
â”‚   â”œâ”€â”€ ğŸ“ api/             # tRPC setup
â”‚   â”‚   â”œâ”€â”€ trpc.ts         # initTRPC, procedures, middleware, ctx
â”‚   â”‚   â”œâ”€â”€ root.ts         # mergeRouters({ queries, mutations, subscriptions })
â”‚   â”‚   â””â”€â”€ ğŸ“ routers/     # Organized by operation type
â”‚   â”‚       â”œâ”€â”€ ğŸ“ queries/ # read-only endpoints â†’ call DAL
â”‚   â”‚       â”œâ”€â”€ ğŸ“ mutations/ # write ops â†’ call services  
â”‚   â”‚       â””â”€â”€ ğŸ“ subscriptions/ # observables
â”‚   â”œâ”€â”€ ğŸ“ auth/           # Authentication setup
â”‚   â”‚   â””â”€â”€ index.ts       # getAuth() for ctx
â”‚   â””â”€â”€ ğŸ“ db/             # Database client
â”‚       â””â”€â”€ index.ts       # PrismaClient singleton
â”‚
â”œâ”€â”€ ğŸ“ lib/                 # Client-side utilities
â”‚   â”œâ”€â”€ ğŸ“ dal/            # **Data Access Layer (READS)**
â”‚   â”‚   â””â”€â”€ post.ts        # cache() for pure reads
â”‚   â”œâ”€â”€ ğŸ“ services/       # domain services (ready for future use)
â”‚   â”œâ”€â”€ ğŸ“ trpc/          # client-side helpers  
â”‚   â”‚   â”œâ”€â”€ client.ts     # tRPC server-side client
â”‚   â”‚   â”œâ”€â”€ react.tsx     # `api` proxy + hooks generator
â”‚   â”‚   â””â”€â”€ query-client.ts # React Query setup
â”‚   â””â”€â”€ http.ts           # fetch wrappers (tags/revalidate)
â”‚
â”œâ”€â”€ ğŸ“ utils/              # Shared utilities
â”‚   â”œâ”€â”€ env.ts            # zod-validated env (server/client split)
â”‚   â””â”€â”€ types.ts          # type definitions
â”‚
â””â”€â”€ ğŸ“ styles/             # Global styles
    â””â”€â”€ globals.css       # Tailwind v4 with CSS variables -->